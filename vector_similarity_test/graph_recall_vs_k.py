import matplotlib.pyplot as plt
import numpy as np



# DATA :
k = np.array([1, 2, 3, 5, 7, 10, 25, 50, 75, 100])


# bf3host_log_kvaried.txt
host_lsh_recall = np.array([1.0, 0.7115, 0.6076666666666675, 0.5105999999999982, 0.4688571428571441, 0.4389000000000008, 0.38772, 0.36773999999999996, 0.36326666666666707, 0.3618600000000005])
# host_lsh_recall = np.array([1.0, 0.66525, 0.5366666666666666, 0.4255, 0.376, 0.3423, 0.27742, 0.25465, 0.24897333333333332, 0.24769999999999998])
host_pq_recall = np.array([1.0, 0.7555, 0.6983333333333317, 0.6362000000000014, 0.6149999999999989, 0.6056000000000016, 0.5979999999999994, 0.60872, 0.6164399999999999, 0.6226299999999987])
# host_pq_recall = np.array([1.0, 0.65725, 0.5488333333333333, 0.45990000000000003, 0.423, 0.39265, 0.3648, 0.36661, 0.37173333333333336, 0.37726499999999996])
host_ivfpq_recall = np.array([1.0, 0.764, 0.6966666666666649, 0.6380000000000007, 0.6141428571428551, 0.6063000000000017, 0.6072799999999999, 0.620540000000001, 0.6312666666666653, 0.63679])
# host_ivfpq_recall = np.array([1.0, 0.668, 0.5555, 0.4642, 0.4278571428571428, 0.399, 0.36962, 0.36863, 0.37261333333333335, 0.377935])
host_hnsw_recall = np.array([0.548, 0.6525, 0.7069999999999985, 0.7541999999999972, 0.7787142857142874, 0.7971999999999962, 0.8257999999999998, 0.832840000000002, 0.8252933333333342, 0.8146100000000001])


host_bf_time = np.array([11.066019295249134, 20.586821757412206, 19.907181306897353, 18.677941913716495, 19.895103717067588, 19.915062610370416, 20.15706221635143, 19.341401732371498, 19.970415234876175, 21.36448751653855])
# host_bf_time = np.array([0.2965616383589804, 0.31058788128818077, 0.32350668287836015, 0.2925656752971311, 0.29953429102897644, 0.29337027699997026, 0.2989283353090286, 0.29735877419201034, 0.30707130837254226, 0.34449729113839567])
host_lsh_time = np.array([1.114103342872113, 1.1505860071629286, 1.3356629214249551, 1.1683098427020013, 1.200197465873013, 1.2370371169721086, 1.381789617240429, 1.2846118505112827, 1.0901423011285563, 1.2603816882086296])
# host_lsh_time = np.array([0.2076359895678858, 0.22565887433787188, 0.20901780078808466, 0.20939074930114052, 0.21404668292962015, 0.21049358105907837, 0.24663752441604933, 0.2118577272631228, 0.21826705965213478, 0.21481160167604685])
host_pq_time = np.array([0.2593623163799445, 0.2587968197961648, 0.25883904735868174, 0.25868787507837016, 0.26423918052266043, 0.25965850179394084, 0.2588343359529972, 0.26011792244389653, 0.26139780165006715, 0.2628290727734566])
# host_pq_time = np.array([0.29653845929230255, 0.27195904271987575, 0.26737358335716027, 0.27586024968574446, 0.26767540560103953, 0.2707055943707625, 0.26879650362146396, 0.2741040310356766, 0.2722231193135182, 0.2772485096938908])
host_ivfpq_time = np.array([0.6635649530217052, 0.6463271433797976, 0.6359212772610287, 0.6084231080797812, 0.6270503420382738, 0.640430971669654, 0.6355563625693321, 0.6251645958982408, 0.6046860152855515, 0.6251150554356476])
# host_ivfpq_time = np.array([0.2298863271716982, 0.2294015733835598, 0.22945111834754547, 0.22925534805593392, 0.23243345770364007, 0.22921400905276337, 0.23300679967117807, 0.23103179899044335, 0.23166145027304688, 0.23564033373259008])
host_hnsw_time = np.array([0.08244979505737622, 0.08222591302668054, 0.09524905557433765, 0.09292499627918005, 0.09501448397835095, 0.08572339918464422, 0.09354349256803592, 0.09267008552948634, 0.09060357138514519, 0.08965838762621085])


# bf3_log_kvaried.txt
bf3_lsh_recall = np.array([1.0, 0.7115, 0.6076666666666675, 0.5105999999999982, 0.4688571428571441, 0.4389000000000008, 0.38772, 0.36773999999999996, 0.36329333333333375, 0.3618700000000005])
# bf3_lsh_recall = np.array([1.0, 0.66525, 0.53666666666667, 0.42550000000000526, 0.3760000000000029, 0.34230000000000244, 0.2774200000000012, 0.2546600000000007, 0.24898000000000034, 0.24770000000000042])
bf3_pq_recall = np.array([1.0, 0.7585, 0.6973333333333316, 0.6378000000000013, 0.6119999999999985, 0.6049000000000018, 0.5972399999999993, 0.60748, 0.615893333333333, 0.6225699999999994])
# bf3_pq_recall = np.array([1.0, 0.6605, 0.5486666666666677, 0.45800000000000207, 0.42407142857143265, 0.39314999999999894, 0.3644800000000016, 0.36591000000000096, 0.37101333333333214, 0.376675])
bf3_ivfpq_recall = np.array([1.0, 0.7635, 0.6999999999999984, 0.6370000000000009, 0.6139999999999975, 0.6040000000000021, 0.6081599999999993, 0.6212000000000011, 0.6316533333333326, 0.6374999999999997])
# bf3_ivfpq_recall = np.array([1.0, 0.66775, 0.5556666666666683, 0.4641000000000019, 0.42685714285714754, 0.3998499999999986, 0.36948000000000136, 0.3682999999999999, 0.37278000000000033, 0.37814500000000073])
bf3_hnsw_recall = np.array([0.546, 0.6515, 0.7059999999999985, 0.7533999999999973, 0.7778571428571445, 0.7967999999999963, 0.8254, 0.832640000000002, 0.8252400000000004, 0.8148300000000002])

bf3_bf_time = np.array([1.3506282413145527, 1.4998857273021713, 1.2808819750013452, 1.631202310983402, 1.6438660923546802, 1.7193028163552906, 1.7257996192978073, 1.7120429956897472, 1.6780553677429755, 1.846966523017424])
# bf3_bf_time = np.array([2.22197065067788, 2.2999817120532193, 1.929354372356708, 2.0866508673255644, 2.2116392282769084, 2.2885235116506615, 2.4379541659727693, 1.9571980152589579, 2.422278366750106, 2.417781783733517])
bf3_lsh_time = np.array([1.003027295305704, 1.0199226920182507, 1.0066567906566586, 1.0394406153354794, 0.9876575509939963, 0.9824721637026718, 1.0115679770242423, 0.9813595673379799, 0.9539247600284094, 0.9164566240118196])
# bf3_lsh_time = np.array([0.6333923690641919, 0.6358298274377981, 0.6251845882895092, 0.710280463565141, 0.6406674272535989, 0.6176036049922308, 0.6372681430075318, 0.6193267253693193, 0.6307041998952627, 0.6268240106292069])
bf3_pq_time = np.array([0.6038905083357046, 0.602470847700412, 0.5995026153201858, 0.6131012233672664, 0.6042122679840153, 0.6098243963594238, 0.6201812940028807, 0.6068789726511264, 0.6104442293290049, 0.6049251819883162])
# bf3_pq_time = np.array([0.48704401768433553, 0.48690356966108084, 0.47544437274336815, 0.47760209441185, 0.47779803730857867, 0.4797634342685342, 0.4848640324392666, 0.5977221486003449, 0.49259017656246823, 0.5019057185854763])
bf3_ivfpq_time = np.array([1.0706029509892687, 1.0799509283388034, 1.1118466136589025, 1.0715527013720323, 1.0590918780459713, 1.0725786396457504, 1.069908314035274, 1.0609194433394198, 1.0861408209893852, 1.12598904230011])
# bf3_ivfpq_time = np.array([0.9218621273369839, 0.9166570162245383, 0.9181425563680629, 0.936582489637658, 0.9212781870737672, 0.9206849056451271, 0.9281905816557506, 0.9435631791129708, 0.9320845709492763, 0.9522352425847203])
bf3_hnsw_time = np.array([0.46688861896594364, 0.46842890535481274, 0.46704568271525204, 0.4688688893026362, 0.4663217500007401, 0.468654470013765, 0.46898208364533883, 0.4687837020416434, 0.4684814266317214, 0.47032098231526714])




# GRAPHS :
plt.title("glove.6B.200d.txt: How Recall Varies with k\n(other parameters chosen so that recall is 100% when k=1)")
plt.grid(color='0.8')
plt.plot(k, host_lsh_recall   ,       color='purple')
plt.plot(k, host_pq_recall    ,       color='teal')
plt.plot(k, host_ivfpq_recall ,       color='orange')
plt.plot(k, host_hnsw_recall ,        color ='navy')
# plt.plot(k, bf3_lsh_recall    , 'o:', color='purple')
# plt.plot(k, bf3_pq_recall     , 'o:', color='teal')
# plt.plot(k, bf3_ivfpq_recall  , 'o:', color='orange')
plt.xscale('log')
plt.ylabel("k-Recall@k")
plt.xlabel("k")
plt.ylim(0, 1.1)
plt.legend(["LSH", "PQ", "IVFPQ", "HNSW"]) #["Host LSH", "Host PQ", "Host IVFPQ", "BF3 LSH", "BF3 PQ", "BF3 IVFPQ"]
# plt.show()#block=False)
plt.savefig("results/recall_vs_k.png")
plt.close()


plt.title("glove.6B.200d.txt: How Recall Time Varies with k\n(other parameters chosen so that recall is 100% when k=1)")
plt.grid(color='0.8')
# plt.scatter(host_IVFPQ_k10_recall, host_IVFPQ_k10_time, color='orange')
# plt.scatter(host_PQ_k10_recall, host_PQ_k10_time, color='teal')
# plt.scatter(host_LSH_k10_recall, host_LSH_k10_time, color='purple')
# plt.ylabel("Time (ms)")
plt.plot(k, host_bf_time    ,       color='k')
plt.plot(k, host_lsh_time   ,       color='purple')
plt.plot(k, host_pq_time    ,       color='teal')
plt.plot(k, host_ivfpq_time ,       color='orange')
plt.plot(k, host_hnsw_time ,       color='navy')
plt.plot(k, bf3_bf_time     , 'o:', color='k')
plt.plot(k, bf3_lsh_time    , 'o:', color='purple')
plt.plot(k, bf3_pq_time     , 'o:', color='teal')
plt.plot(k, bf3_ivfpq_time  , 'o:', color='orange')
plt.plot(k, bf3_hnsw_time  , 'o:', color='navy')
plt.xscale('log')
plt.ylabel("Time (sec)")
plt.xlabel("k")
plt.ylim(bottom=0)
plt.legend(["Host Flat", "Host LSH", "Host PQ", "Host IVFPQ", "Host HNSW", "BF3 Flat", "BF3 LSH", "BF3 PQ", "BF3 IVFPQ", "BF3 HNSW"])
# plt.show()#block=False)
plt.savefig("results/recalltime_vs_k.png")
plt.close()
