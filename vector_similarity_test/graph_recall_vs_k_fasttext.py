import matplotlib.pyplot as plt
import matplotlib.ticker as ticker
import numpy as np



# DATA :
k = np.array([1, 2, 3, 5, 7, 10, 25, 50, 75, 100])



fast_host_bf_time = np.array([208.38042158974955, 352.3189749137188, 362.4151365061601, 368.47042726073414, 
                         362.67198857214925, 385.9652954802538, 378.7179944979337, 371.67291618697345, 
                         363.18255674187094, 359.6219363611502])

fast_host_lsh_recall = np.array([1.0, 0.72655, 0.6345666666666673, 0.5534599999999912, 
                            0.5155571428571503, 0.4802300000000015, 0.42108399999998963, 
                            0.3920419999999964, 0.3783359999999954, 0.3699970000000008])

fast_host_lsh_time = np.array([46.86785144436484, 47.62866039512058, 46.99359579430893, 47.060058168601245, 
                          47.077925475003816, 48.550081433262676, 48.282890192233026, 47.88132502123093, 
                          47.860778062293925, 47.88160128612071])

fast_host_pq_recall = np.array([0.9991, 0.7023, 0.6035666666666645, 0.5245599999999903, 
                           0.48750000000000976, 0.46010000000000184, 0.42311199999999455, 
                           0.4143560000000054, 0.4135013333333403, 0.41469299999999987])

fast_host_pq_time = np.array([12.540313832927495, 12.633938771672547, 12.525809552054852, 12.588103749323636, 
                         12.541989596250156, 12.527978024290254, 12.553150044288486, 12.625101076283803, 
                         12.841607447558394, 12.671807037045559])

fast_host_ivfpq_recall = np.array([0.9992, 0.7006, 0.6053333333333297, 0.5235599999999879, 
                              0.4875285714285802, 0.4645700000000026, 0.4237999999999938, 
                              0.41434200000000554, 0.4130960000000059, 0.41328399999999865])

fast_host_ivfpq_time = np.array([21.945247192246217, 22.102694308695693, 21.90119551618894, 21.640325841028243, 
                            21.96166699162374, 22.009793200995773, 22.110285801813006, 22.168253949688125, 
                            23.08678574487567, 22.888718753742676])

fast_host_hnsw_recall = np.array([0.8941, 0.87445, 0.8683333333333371, 0.8661600000000117, 
                             0.8639142857142877, 0.8613199999999859, 0.8493520000000242, 
                             0.8319759999999684, 0.8153000000000449, 0.7993919999999807])

fast_host_hnsw_time = np.array([0.6516187850696346, 0.6535738993746539, 0.6617486020550132, 0.6533154362502197, 
                           0.6456360194521645, 0.6454550533865889, 0.6515327667196592, 0.6516772884254655, 
                           0.6508354656398296, 0.6551335520731906])


# bf3_log_kvaried.txt
fast_bf3_lsh_recall = np.array([1.0, 0.7115, 0.6076666666666675, 0.5105999999999982, 0.4688571428571441, 0.4389000000000008, 0.38772, 0.36773999999999996, 0.36329333333333375, 0.3618700000000005])
# bf3_lsh_recall = np.array([1.0, 0.66525, 0.53666666666667, 0.42550000000000526, 0.3760000000000029, 0.34230000000000244, 0.2774200000000012, 0.2546600000000007, 0.24898000000000034, 0.24770000000000042])
fast_bf3_pq_recall = np.array([1.0, 0.7585, 0.6973333333333316, 0.6378000000000013, 0.6119999999999985, 0.6049000000000018, 0.5972399999999993, 0.60748, 0.615893333333333, 0.6225699999999994])
# bf3_pq_recall = np.array([1.0, 0.6605, 0.5486666666666677, 0.45800000000000207, 0.42407142857143265, 0.39314999999999894, 0.3644800000000016, 0.36591000000000096, 0.37101333333333214, 0.376675])
fast_bf3_ivfpq_recall = np.array([1.0, 0.7635, 0.6999999999999984, 0.6370000000000009, 0.6139999999999975, 0.6040000000000021, 0.6081599999999993, 0.6212000000000011, 0.6316533333333326, 0.6374999999999997])
# bf3_ivfpq_recall = np.array([1.0, 0.66775, 0.5556666666666683, 0.4641000000000019, 0.42685714285714754, 0.3998499999999986, 0.36948000000000136, 0.3682999999999999, 0.37278000000000033, 0.37814500000000073])
fast_bf3_hnsw_recall = np.array([0.546, 0.6515, 0.7059999999999985, 0.7533999999999973, 0.7778571428571445, 0.7967999999999963, 0.8254, 0.832640000000002, 0.8252400000000004, 0.8148300000000002])

fast_bf3_bf_time = np.array([1.3506282413145527, 1.4998857273021713, 1.2808819750013452, 1.631202310983402, 1.6438660923546802, 1.7193028163552906, 1.7257996192978073, 1.7120429956897472, 1.6780553677429755, 1.846966523017424])
# bf3_bf_time = np.array([2.22197065067788, 2.2999817120532193, 1.929354372356708, 2.0866508673255644, 2.2116392282769084, 2.2885235116506615, 2.4379541659727693, 1.9571980152589579, 2.422278366750106, 2.417781783733517])
fast_bf3_lsh_time = np.array([1.003027295305704, 1.0199226920182507, 1.0066567906566586, 1.0394406153354794, 0.9876575509939963, 0.9824721637026718, 1.0115679770242423, 0.9813595673379799, 0.9539247600284094, 0.9164566240118196])
# bf3_lsh_time = np.array([0.6333923690641919, 0.6358298274377981, 0.6251845882895092, 0.710280463565141, 0.6406674272535989, 0.6176036049922308, 0.6372681430075318, 0.6193267253693193, 0.6307041998952627, 0.6268240106292069])
fast_bf3_pq_time = np.array([0.6038905083357046, 0.602470847700412, 0.5995026153201858, 0.6131012233672664, 0.6042122679840153, 0.6098243963594238, 0.6201812940028807, 0.6068789726511264, 0.6104442293290049, 0.6049251819883162])
# bf3_pq_time = np.array([0.48704401768433553, 0.48690356966108084, 0.47544437274336815, 0.47760209441185, 0.47779803730857867, 0.4797634342685342, 0.4848640324392666, 0.5977221486003449, 0.49259017656246823, 0.5019057185854763])
fast_bf3_ivfpq_time = np.array([1.0706029509892687, 1.0799509283388034, 1.1118466136589025, 1.0715527013720323, 1.0590918780459713, 1.0725786396457504, 1.069908314035274, 1.0609194433394198, 1.0861408209893852, 1.12598904230011])
# bf3_ivfpq_time = np.array([0.9218621273369839, 0.9166570162245383, 0.9181425563680629, 0.936582489637658, 0.9212781870737672, 0.9206849056451271, 0.9281905816557506, 0.9435631791129708, 0.9320845709492763, 0.9522352425847203])
fast_bf3_hnsw_time = np.array([0.46688861896594364, 0.46842890535481274, 0.46704568271525204, 0.4688688893026362, 0.4663217500007401, 0.468654470013765, 0.46898208364533883, 0.4687837020416434, 0.4684814266317214, 0.47032098231526714])




# GRAPHS :
plt.title("fasttext cc.en.300.vec: How Recall Varies with k\n(other parameters chosen so that recall is 100% when k=1)")
plt.grid(color='0.8')
plt.plot(k, fast_host_lsh_recall   ,       color='purple')
plt.plot(k, fast_host_pq_recall    ,       color='teal')
plt.plot(k, fast_host_ivfpq_recall ,       color='orange')
plt.plot(k, fast_host_hnsw_recall ,        color ='navy')
# plt.plot(k, bf3_lsh_recall    , 'o:', color='purple')
# plt.plot(k, bf3_pq_recall     , 'o:', color='teal')
# plt.plot(k, bf3_ivfpq_recall  , 'o:', color='orange')
plt.xscale('log')
plt.ylabel("k-Recall@k")
plt.xlabel("k")
plt.ylim(0, 1.1)
plt.legend(["LSH", "PQ", "IVFPQ", "HNSW"]) #["Host LSH", "Host PQ", "Host IVFPQ", "BF3 LSH", "BF3 PQ", "BF3 IVFPQ"]
# plt.show()#block=False)
plt.savefig("results/fasttext_recall_vs_k.png")
plt.close()


plt.figure(figsize=(8,6))
plt.title("fasttext cc.en.300.vec: How Recall Time Varies with k\n(other parameters chosen so that recall is 100% when k=1)")
plt.grid(color='0.8')

# plot lines without markers to match the recall plot's simple style
plt.plot(k, fast_host_bf_time    , color='k',    linewidth=1.0)
plt.plot(k, fast_host_lsh_time   , color='purple',linewidth=1.0)
plt.plot(k, fast_host_pq_time    , color='teal', linewidth=1.0)
plt.plot(k, fast_host_ivfpq_time , color='orange',linewidth=1.0)
plt.plot(k, fast_host_hnsw_time  , color='navy', linewidth=1.0)

plt.plot(k, fast_bf3_bf_time     , 'o:', color='k')
plt.plot(k, fast_bf3_lsh_time    , 'o:', color='purple')
plt.plot(k, fast_bf3_pq_time     , 'o:', color='teal')
plt.plot(k, fast_bf3_ivfpq_time  , 'o:', color='orange')
plt.plot(k, fast_bf3_hnsw_time   , 'o:', color='navy')

plt.yscale('log')

plt.ylabel("Time (sec)")
plt.xlabel("k")
plt.legend(["Host Flat","Host LSH","Host PQ","Host IVFPQ","Host HNSW",
            "BF3 Flat","BF3 LSH","BF3 PQ","BF3 IVFPQ","BF3 HNSW"], fontsize='small')
plt.tight_layout()
plt.savefig("results/fasttext_recalltime_vs_k.png", dpi=300)
plt.close()
